
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Puzzle Game</title>
    <style>
        .grid {
            display: grid;
            grid-template-columns: repeat(5, 50px);
            gap: 10px;
        }
        .cell {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #000;
            cursor: pointer;
            user-select: none;
        }
        .dragging {
            opacity: 0.5;
        }
        .container {
            display: flex;
        }
        .puzzle {
            flex: 1;
        }
        .graph {
            flex: 1;
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <h1>Puzzle Game</h1>
    <div class="container">
        <div class="puzzle">
            <div class="grid">
                {% for number in state %}
                    <div class="cell" onclick="window.location.href='{% url 'move' forloop.counter0 %}'" draggable="true" ondragstart="drag(event)" ondrop="drop(event, {{ forloop.counter0 }})" ondragover="allowDrop(event)">
                        {{ number }}
                    </div>
                {% endfor %}
            </div>
            <p>Moves: {{ moves }}</p>
        </div>
        <div class="graph">
            <h2>Grafo de Movimientos</h2>
            {% if image %}
                <img src="data:image/png;base64,{{ image }}" alt="Grafo de movimientos">
            {% else %}
                <p>No hay movimientos registrados a√∫n.</p>
            {% endif %}
        </div>
    </div>

    <script>
        function allowDrop(event) {
            event.preventDefault();
        }

        function drag(event) {
            event.dataTransfer.setData("text", event.target.innerText);
            event.target.classList.add("dragging");
        }

        function drop(event, index) {
            event.preventDefault();
            const draggedText = event.dataTransfer.getData("text");
            const target = event.target;
            if (target.innerText == 0 || draggedText == 0) {
                window.location.href = `/move/${index}/`;
            }
        }
    </script>
</body>
</html>
